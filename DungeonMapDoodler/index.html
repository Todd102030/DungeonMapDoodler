<!DOCTYPE HTML>
<html>
    <head>
		<title>Dungeon Map Doodler</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      	<link rel="stylesheet" type="text/css" href="style.css">
      	<!--<link rel="stylesheet" type="text/css" href="style2.css">-->
		<link rel="manifest" href="manifest.json">
    </head>
<body onload='pgWarehouseMap.show()'>
	<div class='topBar' style='text-align: right'><button id="whBtnSave" type="button" class="canvBtn" name="mode" onclick="return ir.show('dimensionPopup')">Change Grid Size</button> &nbsp;&nbsp;<button id="whBtnSave" type="button" class="canvBtn" name="mode" value="8" onclick="return pgWarehouseMap.saveImage()">Save Map Image</button>&nbsp;&nbsp;<button id="whBtnSaveFile" type="button" class="canvBtn" name="mode"  onclick="return pgWarehouseMap.saveFile()">Save</button>&nbsp;&nbsp;<button id="whBtnLoadFile" type="button" class="canvBtn" name="mode"  onclick="return pgWarehouseMap.showFileLoad()">Load</button></div>
<div id='pgWarehouseMap'>
	<canvas id="warehouseCanvas" width="800" height="800" style='border-style:double'></canvas>  
	<div style='display:none'><br>
	<button id="whBtnMove" type="button" class="canvBtn" name="mode" value="1" onclick="return pgWarehouseMap.setMode(1)"> Move</button>
	<button id="whBtnLoc" type="button" class="canvBtn" name="mode" value="2" onclick="return pgWarehouseMap.setMode(2)"> Create Location</button>
	<button id="whBtnWalls" type="button" class="canvBtn" name="mode" value="3" onclick="return pgWarehouseMap.setMode(3)"> Draw Walls/Objects</button>
	<button id="whBtnText" type="button" class="canvBtn" name="mode" value="5" onclick="return pgWarehouseMap.setMode(5)"> Create Text</button>
	<button id="whBtnPreview" type="button" class="canvBtn" name="mode" value="4" onclick="return pgWarehouseMap.setMode(4)"> Preview</button>
	<button id="whBtnEdit" type="button" class="canvBtn" name="mode" value="6" onclick="return pgWarehouseMap.setMode(6)"> Edit </button>
	<button id="whBtnDoodle" type="button" class="canvBtn" name="mode" value="6" onclick="return pgWarehouseMap.setMode(8)"> Doodle </button>
	<button id="whBtnDimen" type="button" class="canvBtn" name="mode" value="7" onclick="return pgWarehouseMap.showDimensionPopup()"> Change dimensions </button>
	
	<br>
	<input type='file' id="imageUpload" accept=".dmd"/>
	<div style="display:inline-block">
		<label id='whImgLabel' for="whImgSlider">Background Visibility 40%</label><br>
		<input id="whImgSlider" type="range" min="0" max="1" step="0.01" value="0.40">
	</div>
	</div>
	
</div>
	
<div style='display:none;'>
	<img id='squarefuzzImg' src='images/squarefuzz.png'>
	<img id='circlefuzzImg' src='images/circlefuzz.png'>
	<img id='hatchingImg' src='hatching.png'>

</div>	
	

	


<div id='locationPopup'>

</div>




<div id='textPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Text:</td>
			<td class='tdl'><textarea rows='2' id='textPopupVal' placeholder='Write your text here'></textarea></td>
		</tr>
		<tr>
			<td class='tdr'>Vertical Text:</td>
			<td class='tdl'><input type="checkbox" id="drawVerticalText" >Draw text vertically</td>
		</tr>
		<tr>
			<td class='tdr'>Font Size</td>
			<td class='tdl'><input type='number' value=14 id='textPopupFontSize'/></td>
		</tr>
	</table>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyTextPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.cancelTextPopup()">Cancel</button>
</div>

<div id='textEditPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Text:</td>
			<td class='tdl'><textarea rows='2' id='textEditVal' placeholder='Write your text here'></textarea></td>
		</tr>
		<tr>
			<td class='tdr'>Vertical Text:</td>
			<td class='tdl'><input type="checkbox" id="textEditVert" >Draw text vertically</td>
		</tr>
		<tr>
			<td class='tdr'>Font Size</td>
			<td class='tdl'><input type='number' value=14 id='textEditFontSize'/></td>
		</tr>
	</table>
	<input type='number' value=0 id='textEditId' style="display:none"/>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyEditTextPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyDeleteTextPopup()">Delete</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyCancelTextPopup()">Cancel</button>
</div>

<div id='wallEditPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Width in feet: </td>
			<td class='tdl'><input type="number" id="wallEditWidth" ></td>
		</tr>
		<tr>
			<td class='tdr'>Height in feet: </td>
			<td class='tdl'><input type='number' id='wallEditHeight'/></td>
		</tr>
	</table>
	<input type='number' value=0 id='wallEditId' style="display:none"/>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyEditWallPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyDeleteWallPopup()">Delete</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyCancelWallPopup()">Cancel</button>
</div>

<div id='locEditPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Width in feet: </td>
			<td class='tdl'><input type="number" id="locEditWidth" ></td>
		</tr>
		<tr>
			<td class='tdr'>Height in feet: </td>
			<td class='tdl'><input type='number' id='locEditHeight'/></td>
		</tr>
		<tr>
			<td class='tdr'>Location: </td>
			<td class='tdl' id="locEditCell"></td>
		</tr>
	</table>
	<input type='number' value=0 id='locEditId' style="display:none"/>
	<input type='number' value=0 id='locEditDeleteOnCancel' style="display:none"/>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyEditLocPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyDeleteLocPopup()">Delete</button>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyCancelLocPopup()">Cancel</button>
</div>
	
<div id='imageSavePopup' style='border-style:double;background-color:#fff;display:none;z-index:5000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<h2>Export Image File</h2>
	<table>
		<tr>
			<td class='tdr'>File Name:</td>
			<td class='tdl'>
				<input type="text" id="imageSaveName" value='DungeonMapDoodle.png' >
			</td>
		</tr>
		<tr>
			<td class='tdr'>Background Colour:</td>
			<td class='tdl'><!--<input type='color' value='rgb()' id='imageSaveColor'/>-->
				<input type="radio" id="imageSaveColorWhite" name="imageSaveColor" checked='checked' value="color" >
				<label for="imageSaveColorWhite">Coloured <input type='color' value='#ffffff' id='imageSaveColorColor'></label><br>
				<input type="radio" id="imageSaveColorTrans" name="imageSaveColor" value="rgba(0,0,0,0)" >
				<label for="imageSaveColorTrans">Transparent</label><br>
			</td>
		</tr>
	</table>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.saveImageConfirm()">Save</button>
	<button type="button" class="canvBtn" onclick="ir.hide('imageSavePopup')">Cancel</button>
</div>

<div id='dimensionPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		
		<tr>
			<td class='tdr'>Width in Feet:</td>
			<td class='tdl'><input type="number" style='width:100px;' id="dimensionPopupX" value='10'></td>
		</tr>
		<tr>
			<td class='tdr'>Height in Feet:</td>
			<td class='tdl'><input type="number" style='width:100px;' id="dimensionPopupY" value='10'></td>
		</tr>
		<tr>
			<td class='tdr'>Feet Per Box:</td>
			<td class='tdl'><input type="number" style='width:100px;' value='5' id="dimensionPopupStep" ></td>
		</tr>
		<tr>
			<td class='tdr'>Box Size in Pixels:</td>
			<td class='tdl'><input type="number" style='width:100px;' value='5' id="dimensionPopupBoxSize" ></td>
		</tr>
		<tr><td>Warning: this will clear out any doodles you currently have</td></tr>
	</table>
	<button type="button" class="canvBtn" onclick="pgWarehouseMap.applyDimensions()">Okay</button>
	<button type="button" class="canvBtn" onclick="ir.hide('dimensionPopup')">Cancel</button>
</div>
	
<div style='display:none'>
	<a id='link'></a>
	<input type='file' id="stampUpload" accept="image/gif, image/jpeg, image/png"/>
</div>
	
	
<div class="floatingModes popup">
	<div class='floatingBtns'>
	<div class='modeBtn' title="Free Draw" id='modeDoodle' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmDoodle' src="doodle.png" width='32px' height='32px'></div><div class='modeBtn' title="Snap To Grid" id='modeSnapToGrid' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmSnapToGrid' src="snaptogrid.png" width='32px' height='32px'></div><div class='modeBtn' title="Hatching" id='modeHatching' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmHatching' src="hatch.png" width='32px' height='32px'></div><div class='modeBtn' title="Line" id='modeLine' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmLine' src="line.png" width='32px' height='32px'></div><div class='modeBtn' title="Stamps" id='modeStamps' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmStamps' src="stamp.png" width='32px' height='32px'></div><div class='modeBtn' title="Move" id='modeMove' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmMove' src="move.png" width='32px' height='32px'></div><div class='modeBtn' title="Room Tool" id='modeRoomTool' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmRoomTool' src="roomtool.png" width='32px' height='32px'></div><div class='modeBtn' title="Erase" id='modeErase' onclick='pgWarehouseMap.clickMode(event)'><img id='imgmErase' src="erase.png" width='32px' height='32px'></div>
	</div>
	<div class='paramBox' id='paramBox'></div>
</div>	
	
	
	
<div id='passwordPrompt' style='padding-top:80px;text-align: center;display:none;position:fixed;width:100%;height:100%;left:0;top:0;background-color:white;'>
	
	Please enter the password to access Dungeon Map Doodler beta
	<div style='margin-left:auto;margin-right:auto;width:30%'><table>
		<tr>
			<td class='tdr'>Password</td>
			<td class='tdl'><input type='text'  id='passwordPromptInput'/></td>
		</tr>
		<tr>
			<td colspan='2' class='tdr' id='passwordError'></td>
		</tr>
		<tr>
			<td><button type="button" class="canvBtn" onclick="pgWarehouseMap.showPasswordPromptCallback()">Okay</button></td>
		</tr>
	</table></div>
	
</div>
	
<script src='irutil.js'></script>
<script src='irstore.js'></script>
<script src='keyedarray.js'></script>
<script src='smoothpopup.js'></script>
<script src='modes.js'></script>
<script src="warehouseMap.js"></script>  
<script src="warehouseMap2.js"></script>
<script>
  if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
  navigator.serviceWorker.register('service-worker.js').then(function(registration) {
  // Registration was successful
  console.log('Registered!');
  }, function(err) {
  // registration failed :(
  console.log('ServiceWorker registration failed: ', err);
  }).catch(function(err) {
  console.log(err);
  });
  });
  } else {
  console.log('service worker is not supported');
  }
  </script>


</body>
</html>