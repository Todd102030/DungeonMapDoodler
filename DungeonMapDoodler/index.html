<!DOCTYPE HTML>
<html>
    <head>
		<title>Dungeon Map Doodler</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      	<link rel="stylesheet" type="text/css" href="style.css">
        <link rel="apple-touch-icon" href="touch-icon-iphone.png">
        <link rel="apple-touch-icon" sizes="152x152" href="icon-152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">
        <link rel="apple-touch-icon" sizes="167x167" href="icon-167.png">
      	<!--<link rel="stylesheet" type="text/css" href="style2.css">-->
		<link rel="manifest" href="manifest.json">
        <link rel="icon" type="image/png"   href="icon-192.png">
    </head>
<body onload='doodler.show()'>
	<div class='flex-container'>
		<div class='topBar' style='text-align: right'>
			<nav id="nav">
				<ul id="navigation">
					<li><a href="/">Dungeon Map Doodler</a></li>
					<li><a href="#">File &raquo;</a>
						<ul>
							<li><a href="#" onclick="return doodler.saveFile()">Save</a></li>
							<li><a href="#" onclick="return doodler.showFileLoad()">Load</a></li>
							<li><a href="#" onclick="return doodler.saveImage()">Export Image</a></li>

						</ul>
					</li>
					<li><a href="#">Grid &raquo;</a>
						<ul>
							<li><a href="#" onclick="return doodler.toggleGridOutside()">Toggle Outer Grid</a></li>
							<li><a href="#" onclick="ir.show('dimensionPopup');doodler.popupShowing=true;">Change Grid Dimensions</a></li>
						</ul>
					</li>
					<li><a href="#">Options &raquo;</a>
						<ul>
							<li><a href="#" onclick="return doodler.toggleToolDock()">Dock/Undock Tools</a></li>
						</ul>
					</li>
					<!--<li><a href="#" class="last" onclick="return doodler.showAboutPopup()">About</a></li>-->
				</ul>
			</nav>
		</div>
		
		<div id='doodler'>
			<canvas id="warehouseCanvas" width="800" height="800" ></canvas>  
			<div style='display:none'><br>

			<br>
			<input type='file' id="imageUpload" accept=".dmd"/>
			<div style="display:inline-block">
				<label id='whImgLabel' for="whImgSlider">Background Visibility 40%</label><br>
				<input id="whImgSlider" type="range" min="0" max="1" step="0.01" value="0.40">
			</div>
			</div>

		</div>
	</div>
	
<div style='display:none;'>
	<img id='squarefuzzImg' src='images/squarefuzz.png'>
	<img id='circlefuzzImg' src='images/circlefuzz.png'>
	<img id='hatchingImg' src='hatching.png'>
	<img id='hatchingImgDots' src='hatches/dots.svg'>
	<img id='hatchingImgJPCrosshatch' src='hatches/DMD Crosshatch Pattern.svg'>
	<img id='hatchingImgJPHalftone' src='hatches/DMD Halftone Pattern.svg'>
	<img id='hatchingImgJPStipple' src='hatches/DMD Stipple Pattern.svg'>
	<img id='hatchingImgJPStone' src='hatches/DMD Stone Pattern.svg'>
	<img id='hatchingImgJPGrass' src='hatches/DMG Grass Pattern.svg'>
	<img id='hatchingImgGrass' src='floortiles/grasstile.jpg'>
	<img id='hatchingImgRock' src='floortiles/rocktile.jpg'>
    
	<img id='brick1' src='floortiles/brick1.svg'>
	<img id='metal1' src='floortiles/metal1.svg'>
	<img id='wood1' src='floortiles/wood1.svg'>
	<img id='magma1' src='floortiles/magma1.svg'>
	<img id='sand1' src='floortiles/sand1.svg'>
	<img id='sand2' src='floortiles/sand2.svg'>
	<img id='space1' src='floortiles/space1.svg'>
	<img id='space2' src='floortiles/space2.svg'>
	<img id='space3' src='floortiles/space3.svg'>
	<img id='space4' src='floortiles/space4.svg'>
	<img id='stone1' src='floortiles/stone1.svg'>
	<img id='water1' src='floortiles/water1.svg'>
	
	
	<label for='imageSaveIsometric'><input type='checkbox' id='imageSaveIsometric'> Isometric</label>
	
</div>	
	

	


<div id='locationPopup'>

</div>




<div id='textPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;max-width:600px;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Text:</td>
			<td class='tdl'><textarea rows='2' id='textPopupVal' style="font-family: 'Times New Roman';font-size:18pt" placeholder='Write your text here'></textarea></td>
		</tr>
		<tr>
			<td class='tdr'>Vertical Text:</td>
			<td class='tdl'><input type="checkbox" id="drawVerticalText" >Draw text vertically</td>
		</tr>
		<tr>
			<td class='tdr'>Font Size</td>
			<td class='tdl'><input type='number' value='40' id='textPopupFontSize'/></td>
		</tr>
		<tr>
			<td class='tdr'>Font</td>
			<td class='tdl'><select id="textPopupFont" onchange="Modes.TextTool.changeFontPopup(event, 'textPopupVal')">
				<option value='Times New Roman'>Times New Roman</option>
				<option value='Arial'>Arial</option>
				<option value='Helvetica'>Helvetica</option>
				<option value='mono'>Monospace</option>
				<option value='blacklet'>Handwritten Calligraphy</option>
				<option value='handwriting_main'>Handwritten</option>
				<option value='arush_shiny'>Arush Shiny</option>
				<option value='castaway'>Castaway Fill</option>
				<option value='castaway_inline'>Castaway Inline</option>
				<option value='decorative_stencil'>Decorative Stencil</option>
				<option value='gamejot'>Gamejot</option>
				<option value='nerik'>Nerik</option>
				<option value='pioneer'>Pioneer</option>
				<option value='Metal_Mania'>Metal Mania</option>
				<option value='Bangers'>Bangers</option>
				<option value='Hobbiton'>Hobbiton Brush Hand</option>
				<option value='Tengwar'>Tengwar Annatar</option>
				<option value='Tengwar_i'>Tengwar Annatar Italic</option>
				<option value='Rune'>Rune</option>
				</select></td>
		</tr>
	</table>
	<button type="button" class="canvBtn" onclick="doodler.applyTextPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="doodler.cancelTextPopup();doodler.popupShowing=false;">Cancel</button>
</div>

<div id='textEditPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Text:</td>
			<td class='tdl'><textarea style='font-size:18pt;' rows='2' id='textEditVal' placeholder='Write your text here'></textarea></td>
		</tr>
		<tr>
			<td class='tdr'>Vertical Text:</td>
			<td class='tdl'><input type="checkbox" id="textEditVert" >Draw text vertically</td>
		</tr>
		<tr>
			<td class='tdr'>Font Size</td>
			<td class='tdl'><input type='number' value=14 id='textEditFontSize'/></td>
		</tr>
		<tr>
			<td class='tdr'>Font</td>
			<td class='tdl'><select id="textEditFont" onchange="Modes.TextTool.changeFontPopup(event, 'textEditVal')">
				<option value='Times New Roman'>Times New Roman</option>
				<option value='Arial'>Arial</option>
				<option value='Helvetica'>Helvetica</option>
				<option value='mono'>Monospace</option>
				<option value='blacklet'>Handwritten Calligraphy</option>
				<option value='handwriting_main'>Handwritten</option>
				<option value='arush_shiny'>Arush Shiny</option>
				<option value='castaway'>Castaway Fill</option>
				<option value='castaway_inline'>Castaway Inline</option>
				<option value='decorative_stencil'>Decorative Stencil</option>
				<option value='gamejot'>Gamejot</option>
				<option value='nerik'>Nerik</option>
				<option value='pioneer'>Pioneer</option>
				<option value='Metal_Mania'>Metal Mania</option>
				<option value='Bangers'>Bangers</option>
				<option value='Hobbiton'>Hobbiton Brush Hand</option>
				<option value='Tengwar'>Tengwar Annatar</option>
				<option value='Tengwar_i'>Tengwar Annatar Italic</option>
				<option value='Rune'>Rune</option>
				</select></td>
		</tr>
	</table>
	<input type='number' value=0 id='textEditId' style="display:none"/>
	<button type="button" class="canvBtn" onclick="doodler.applyEditTextPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="doodler.applyDeleteTextPopup()">Delete</button>
	<button type="button" class="canvBtn" onclick="doodler.applyCancelTextPopup()">Cancel</button>
</div>

<div id='wallEditPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Width in feet: </td>
			<td class='tdl'><input type="number" id="wallEditWidth" ></td>
		</tr>
		<tr>
			<td class='tdr'>Height in feet: </td>
			<td class='tdl'><input type='number' id='wallEditHeight'/></td>
		</tr>
	</table>
	<input type='number' value=0 id='wallEditId' style="display:none"/>
	<button type="button" class="canvBtn" onclick="doodler.applyEditWallPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="doodler.applyDeleteWallPopup()">Delete</button>
	<button type="button" class="canvBtn" onclick="doodler.applyCancelWallPopup()">Cancel</button>
</div>

<div id='locEditPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		<tr>
			<td class='tdr'>Width in feet: </td>
			<td class='tdl'><input type="number" id="locEditWidth" ></td>
		</tr>
		<tr>
			<td class='tdr'>Height in feet: </td>
			<td class='tdl'><input type='number' id='locEditHeight'/></td>
		</tr>
		<tr>
			<td class='tdr'>Location: </td>
			<td class='tdl' id="locEditCell"></td>
		</tr>
	</table>
	<input type='number' value=0 id='locEditId' style="display:none"/>
	<input type='number' value=0 id='locEditDeleteOnCancel' style="display:none"/>
	<button type="button" class="canvBtn" onclick="doodler.applyEditLocPopup()">Okay</button>
	<button type="button" class="canvBtn" onclick="doodler.applyDeleteLocPopup()">Delete</button>
	<button type="button" class="canvBtn" onclick="doodler.applyCancelLocPopup()">Cancel</button>
</div>
	
<div id='imageSavePopup' style='border-style:double;background-color:#fff;display:none;z-index:5000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<h2>Export Image File</h2>
	<table>
		<tr>
			<td class='tdr'>File Name:</td>
			<td class='tdl'>
				<input type="text" id="imageSaveName" value='DungeonMapDoodle' >
			</td>
		</tr>
		<tr>
			<td class='tdr'>Background Colour:</td>
			<td class='tdl'><!--<input type='color' value='rgb()' id='imageSaveColor'/>-->
				<input type="radio" id="imageSaveColorWhite" name="imageSaveColor" checked='checked' value="color" >
				<label for="imageSaveColorWhite">Coloured <input type='color' value='#ffffff' id='imageSaveColorColor'></label><br>
				<input type="radio" id="imageSaveColorTrans" name="imageSaveColor" value="rgba(0,0,0,0)" >
				<label for="imageSaveColorTrans">Transparent</label><br>
			</td>
		</tr>
        <tr>
			<td class='tdr'>File Type:</td>
			<td class='tdl'>
				<input type="radio" id="imageSaveFilePng" checked='checked' name="imageSaveFile" value="image/png" >
				<label for="imageSaveFilePng">PNG</label>
				<input type="radio" id="imageSaveFileJpeg" name="imageSaveFile" value="image/jpeg" >
				<label for="imageSaveFileJpeg">JPG</label>
				<input type="radio" id="imageSaveFileBmp" name="imageSaveFile" value="image/bmp" >
				<label for="imageSaveFileBmp">BMP</label>
			</td>
		</tr>
	</table>
	<button type="button" class="canvBtn" onclick="doodler.saveImageConfirm()">Save</button>
	<button type="button" class="canvBtn" onclick="ir.hide('imageSavePopup');doodler.popupShowing=false;">Cancel</button>
</div>
	
<div id='creditPopup' style='border-style:double;background-color:#fff;display:none;z-index:5000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<h2>Credits</h2>
	<a href="https://www.freepik.com/free-photos-vectors/background">Background vector created by 0melapics - www.freepik.com</a>
    <a href='https://www.freepik.com/free-photos-vectors/background'>Background vector created by 0melapics - www.freepik.com</a>
</div>

<div id='dimensionPopup' style='border-style:double;background-color:#fff;display:none;z-index:10000;width:auto;height:auto;position:fixed;left:35%; top:20%'>
	<table>
		
		<tr>
			<td class='tdr'>Width in Feet:</td>
			<td class='tdl'><input type="number" style='width:100px;' id="dimensionPopupX" value='10'></td>
		</tr>
		<tr>
			<td class='tdr'>Height in Feet:</td>
			<td class='tdl'><input type="number" style='width:100px;' id="dimensionPopupY" value='10'></td>
		</tr>
		<tr>
			<td class='tdr'>Feet Per Box:</td>
			<td class='tdl'><input type="number" style='width:100px;' value='5' id="dimensionPopupStep" ></td>
		</tr>
		<tr>
			<td class='tdr'>Box Size in Pixels:</td>
			<td class='tdl'><input type="number" style='width:100px;' value='5' id="dimensionPopupBoxSize" ></td>
		</tr>
		<tr><td>Warning: this will clear out any doodles you currently have</td></tr>
	</table>
	<button type="button" class="canvBtn" onclick="doodler.applyDimensions()">Okay</button>
	<button type="button" class="canvBtn" onclick="ir.hide('dimensionPopup');doodler.popupShowing=false;">Cancel</button>
</div>
	
<div style='display:none'>
	<a id='link'></a>
	<input type='file' id="stampUpload" accept="image/gif, image/jpeg, image/png"/>
</div>
	
<div class='floatingControlsLeft'>
	<div class='floatBtn' onclick="doodler.zoom(1, true)"><img title="Zoom In" src='images/plus.svg' width='40px' height='40px'></div>
	<div class='floatBtn' onclick="doodler.zoom(-1, true)"><img title="Zoom Out" src='images/minus.svg' width='40px' height='40px'></div>
	<div id='zoomSizeLabel' style='font-size: 9pt'></div>
	<div class='floatBtn' onclick="doodler.undo()"><img title='Undo' src='images/undo.svg' width='40px' height='40px'></div>
	<div class='floatBtn' onclick="doodler.redo()"><img title="Redo" src='images/redo.svg' width='40px' height='40px'></div>
	
	
</div>	
    
<div id="errorBox" style='display:none;position:fixed;bottom:0;left:0;right:0;width:100%;height:80px;background-color:azure'></div>
	
	
<div class="floatingModes popup" id='floatingModes'>
	<button id='dockOpenCloseBtn' class='modeBtn' style='padding:0;margin-left: 0px;float:left;outline:none;' type="button" onclick="doodler.toggleDockOpen()"><img id='dockOpenCloseImg' src="close.png" width='32px' height='32px'></button>
	<div class='floatingContainer'>
		<details open id='layerDetails'>
			<summary>Layer Options</summary>
			<div id="layerList"></div>
			<div class='layerBtns'>
				<div class='modeBtn' title="Add Layer" onclick='doodler.addLayer()'><img src="images/plus.svg" width='32px' height='32px'></div><div class='modeBtn' title="Delete Layer" onclick='doodler.deleteLayer()'><img src="images/delete.png" width='32px' height='32px'></div><div class='modeBtn' title="Raise Layer" onclick='doodler.raiseLayer()'><img src="images/raise.png" width='32px' height='32px'></div><div class='modeBtn' title="Lower Layer" onclick='doodler.lowerLayer()'><img src="images/lower.png" width='32px' height='32px'></div>
				</div>
		</details>
		<details open id='toolDetails'>
			<summary>Tool Options</summary>
			<div id='toolFlexbox' style='display:flex'>
				<div class='floatingBtns'>
				<div class='modeBtn' title="Free Draw" id='modeDoodle' onclick='doodler.clickMode(event)'><img id='imgmDoodle' src="doodle.png" width='32px' height='32px'></div><div class='modeBtn' title="Snap To Grid" id='modeSnapToGrid' onclick='doodler.clickMode(event)'><img id='imgmSnapToGrid' src="snaptogrid.png" width='32px' height='32px'></div><div class='modeBtn' title="Hatching" id='modeHatching' onclick='doodler.clickMode(event)'><img id='imgmHatching' src="hatch.png" width='32px' height='32px'></div><div class='modeBtn' title="Line" id='modeLine' onclick='doodler.clickMode(event)'><img id='imgmLine' src="line.png" width='32px' height='32px'></div><div class='modeBtn' title="Stamps" id='modeStampTool' onclick='doodler.clickMode(event)'><img id='imgmStampTool' src="stamp.png" width='32px' height='32px'></div><div class='modeBtn' title="Move" id='modeMove' onclick='doodler.clickMode(event)'><img id='imgmMove' src="move.png" width='32px' height='32px'></div><div class='modeBtn' title="Room Tool" id='modeRoomTool' onclick='doodler.clickMode(event)'><img id='imgmRoomTool' src="roomtool.png" width='32px' height='32px'></div><div class='modeBtn' title="Erase" id='modeErase' onclick='doodler.clickMode(event)'><img id='imgmErase' src="erase.png" width='32px' height='32px'></div><div class='modeBtn' title="Shape Tool" id='modeShapeTool' onclick='doodler.clickMode(event)'><img id='imgmShapeTool' src="shapetool.png" width='32px' height='32px'></div><div class='modeBtn' title="Text Tool" id='modeTextTool' onclick='doodler.clickMode(event)'><img id='imgmTextTool' src="images/texttool.png" width='32px' height='32px'></div>
				</div>
				<div class='paramBox' id='paramBox'></div>
			</div>
		</details>
	</div>
</div>	
	
	
	
<div id='passwordPrompt' style='padding-top:80px;text-align: center;display:none;position:fixed;width:100%;height:100%;left:0;top:0;background-color:white;'>
	
	Please enter the password to access Dungeon Map Doodler beta
	<div style='margin-left:auto;margin-right:auto;width:30%'><table>
		<tr>
			<td class='tdr'>Password</td>
			<td class='tdl'><input type='text'  id='passwordPromptInput'/></td>
		</tr>
		<tr>
			<td colspan='2' class='tdr' id='passwordError'></td>
		</tr>
		<tr>
			<td><button type="button" class="canvBtn" onclick="doodler.showPasswordPromptCallback()">Okay</button></td>
		</tr>
	</table></div>
	
</div>
	
<script type="text/javascript">
    window.onbeforeunload = function() {
        return "Are you sure you want to leave the page? Anything unsaved will be lost";
    }
</script>	
	
<script src='irutil.js'></script>
<script src='irstore.js'></script>
<script src='keyedarray.js'></script>
<script src='smoothpopup.js'></script>
<script src='dmd.js'></script>
<script src='stamps.js'></script>
<script src='modedoodle.js'></script>
<script src='modeerase.js'></script>
<script src='modehatching.js'></script>
<script src='modeline.js'></script>
<script src='modemove.js'></script>
<script src='moderoomtool.js'></script>
<script src='modesnaptogrid.js'></script>
<script src='modeshapetool.js'></script>
<script src='modetext.js'></script>
<script src='modestamps.js'></script>
<script src='modes.js'></script>
<script src="warehouseMap.js"></script>  
<script src="warehouseMap2.js"></script>
<script>
  if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
  navigator.serviceWorker.register('service-worker.js').then(function(registration) {
  // Registration was successful
  console.log('Registered!');
  }, function(err) {
  // registration failed :(
  console.log('ServiceWorker registration failed: ', err);
  }).catch(function(err) {
  console.log(err);
  });
  });
  } else {
  console.log('service worker is not supported');
  }
  </script>

	
<!-- Start Open Web Analytics Tracker -->
<script type="text/javascript">
//<![CDATA[
var owa_baseUrl = 'https://uncon.ca/openwebanalytics/';
var owa_cmds = owa_cmds || [];
owa_cmds.push(['setSiteId', 'ffb87c343d5de595b88243c63a1ca70d']);
owa_cmds.push(['trackPageView']);
owa_cmds.push(['trackClicks']);

(function() {
	var _owa = document.createElement('script'); _owa.type = 'text/javascript'; _owa.async = true;
	owa_baseUrl = ('https:' == document.location.protocol ? window.owa_baseSecUrl || owa_baseUrl.replace(/http:/, 'https:') : owa_baseUrl );
	_owa.src = owa_baseUrl + 'modules/base/js/owa.tracker-combined-min.js';
	var _owa_s = document.getElementsByTagName('script')[0]; _owa_s.parentNode.insertBefore(_owa, _owa_s);
}());
//]]>
</script>

</body>
</html>